# NYYT

###### The input data files are in Parquet format.
###### The data files are from Oct 2022 to Sept 2023 (Source: https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page)
###### To query these files, Apache Drill has been used. This can be used either in distributed mode or embedded mode. Make sure enough memory is configured that can handle input data.

Uppload all the data files in a specific directory inside Drill installation.

    DATA_DIRECTORY=`/Users/abhishek/apps/drill/apache-drill-1.21.1/sample-data/database/YTD`
Now `DATA_DIRECTORY` can be treated as a single table which can be used to query.

#### Scenario and the corresponding query:
1. Average Fare Amount: Calculate the average fare amount for all trips.
   
         select avg(fare_amount) from dfs.DATA_DIRECTORY;
  
2.  Peak Hour Analysis: Determine the hour of the day with the highest number of trips

         select hour(tpep_pickup_datetime) as hourOfDay, count(hour(tpep_pickup_datetime)) as totalTrips from dfs.DATA_DIRECTORY group by hour(tpep_pickup_datetime) order by totalTrips desc limit 1;
   
3.  Longest Trip: Identify the trip with the longest distance traveled

        select * from dfs.DATA_DIRECTORY where passenger_count is not null and payment_type <> 0 order by trip_distance desc limit 1;

        OR
    
        select tpep_pickup_datetime, tpep_dropoff_datetime, trip_distance, fare_amount, total_amount from dfs.DATA_DIRECTORY where trip_distance = (select max(trip_distance) from dfs.DATA_DIRECTORY);

4.  Revenue Analysis: Calculate the total revenue generated by the taxi service, including fare amount and tips

        select cast (sum(total_amount) as DECIMAL) as revenueGenerated from dfs.DATA_DIRECTORY;
     
5.  Airport Fee Analysis: Analyze the distribution of airport fees for each VendorID

        select cast(VendorId as INT) as vendor, cast (sum(airport_fee) as DECIMAL) as airportFees from dfs.DATA_DIRECTORY group by cast(VendorId as INT);
    
6.  Monthly Revenue Trend: Calculate the monthly revenue trend for the taxi service over the available data

        select month(tpep_pickup_datetime) as _month, cast (sum(total_amount) as DECIMAL) as revenueGenerated from dfs.DATA_DIRECTORY group by _month order by _month;
    
7.  Time Series Analysis: Analyze the time series data for trip counts, fare amounts, or tip amounts, and identify any trends or seasonality

        TBD
   
  
